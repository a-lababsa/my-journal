{{ define "main" }}
<div class="home-intro">
    <div class="date-display">
        {{ now.Format "2 janvier 2006" }}
    </div>
    <p class="home-description">
        <em>{{ .Site.Params.description | default "Fragments d'ombre et éclats de lumière" }}</em>
    </p>
</div>

{{- $lastCitation := first 1 (where .Site.RegularPages "Type" "citations") -}}
{{- with index $lastCitation 0 -}}
<aside class="home-citation" aria-label="Dernière citation">
    <blockquote class="home-citation-text">
        {{ .Content }}
    </blockquote>
    <footer class="home-citation-footer">
        {{- with .Params.theme -}}
        <span class="citation-theme">{{ . }}</span>
        {{- end -}}
        <a href="{{ "/citations/" | relURL }}" class="home-citation-link">Toutes les citations →</a>
    </footer>
</aside>
{{- end -}}

{{- $posts := where .Site.RegularPages "Type" "posts" -}}
{{- $recentPosts := first 8 $posts -}}

{{- if $recentPosts -}}
<section class="journal-entries" aria-label="Dernières entrées du journal">
    <h2 class="entries-title">Dernières entrées</h2>

    {{- range $recentPosts -}}
    <article class="journal-entry mood-{{ .Params.mood | default "neutral" | urlize }}">
        <div class="entry-meta">
            <span class="mood-indicator" aria-hidden="true"></span>
            <time class="entry-date" datetime="{{ .Date.Format "2006-01-02" }}">
                {{ .Date.Format "2 janvier 2006" }}
            </time>
            {{- if .Params.categories -}}
            <span class="entry-category">{{ index .Params.categories 0 }}</span>
            {{- end -}}
            <span class="reading-time">{{ .ReadingTime }} min</span>
        </div>

        <h3 class="entry-title">
            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
        </h3>

        <div class="entry-excerpt">
            {{ if .Summary }}
                {{ .Summary }}
                {{- if .Truncated -}}
                <p class="continue-reading">
                    <a href="{{ .RelPermalink }}">Lire la suite →</a>
                </p>
                {{- end -}}
            {{ else }}
                {{ .Content | truncate 200 }}
                <p class="continue-reading">
                    <a href="{{ .RelPermalink }}">Lire la suite →</a>
                </p>
            {{ end }}
        </div>
    </article>
    {{- end -}}
</section>
{{- end -}}
{{ end }}
